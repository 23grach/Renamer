<!DOCTYPE html>
<html>
<head>
  <style>
   body {
  font-family: Inter, sans-serif;
  padding: 16px 20px;
  color: #333;
  display: flex;
  flex-direction: column;
  height: 100vh;
  margin: 0;
  overflow: hidden;
}

.settings-section {
  overflow-y: auto;
  flex: 1;
}



.setting-item {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  gap: 8px;
}

.setting-item input[type="checkbox"] {
  flex-shrink: 0;
  margin: 0;
  width: 14px;
  height: 14px;
}

.setting-item label {
  font-size: 12px;
  line-height: 1.4;
  flex: 1;
  margin: 0;
}

.section {
  margin-bottom: 24px;
}

.footer {
  padding-top: 12px;
  padding-bottom: 12px;
  border-top: 1px solid #E5E5E5;
  text-align: center;
  font-size: 12px;
  color: #666;
  background: white;
  position: sticky;
  bottom: 0;
}

.footer a {
  color: #18A0FB;
  text-decoration: none;
}

.footer a:hover {
  text-decoration: underline;
}

.version {
  margin-top: 4px;
  font-size: 10px;
  color: #999;
}

.version a {
  color: #999;
  text-decoration: none;
}

.version a:hover {
  text-decoration: underline;
}

.group-toggle {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
  gap: 8px;
}

.group-checkbox {
  flex-shrink: 0;
  margin: 0;
  width: 14px;
  height: 14px;
}

.layer-type-header {
  font-size: 12px;
  font-weight: 600;
  color: #1E1E1E;
  margin: 0;
  flex: 1;
}

.group-disabled .setting-item {
  opacity: 0.5;
  pointer-events: none;
}

.group-settings {
  margin-left: 22px;
}

.action-buttons {
  padding: 16px 20px;
  border-top: 1px solid #E5E5E5;
  background: white;
}

.rename-button {
  width: 100%;
  padding: 12px;
  background: #18A0FB;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s ease;
}

.rename-button:hover {
  background: #1592E6;
}

.rename-button:active {
  background: #0F7BCF;
}

  </style>
</head>
<body>
  <div class="settings-section">
    <!-- Text Layers -->
    <div class="section" id="textLayerSection">
      <div class="group-toggle">
        <input type="checkbox" class="group-checkbox" id="toggleTextGroup" checked>
        <label for="toggleTextGroup" class="layer-type-header">üÖ∞Ô∏è Text Layers</label>
      </div>
      <div class="group-settings">
        <div class="setting-item">
          <input type="checkbox" id="useTextContent" checked>
          <label for="useTextContent">Use content as name</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeTextColor" checked>
          <label for="includeTextColor">Include text color</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeTextStyle" checked>
          <label for="includeTextStyle">Include text style name</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeTextOpacity" checked>
          <label for="includeTextOpacity">Include opacity</label>
        </div>
      </div>
    </div>

    <!-- Containers -->
    <div class="section" id="containerLayerSection">
      <div class="group-toggle">
        <input type="checkbox" class="group-checkbox" id="toggleContainerGroup" checked>
        <label for="toggleContainerGroup" class="layer-type-header">üì¶ Containers</label>
      </div>
      <div class="group-settings">
        <div class="setting-item">
          <input type="checkbox" id="includeContainerType" checked>
          <label for="includeContainerType">Include container type</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeContainerSize" checked>
          <label for="includeContainerSize">Include container size</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeChildrenCount" checked>
          <label for="includeChildrenCount">Include number of children</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeContainerOpacity" checked>
          <label for="includeContainerOpacity">Include opacity</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="useFirstTextContent" checked>
          <label for="useFirstTextContent">Use first text layer content</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="useAutoLayoutNames" checked>
          <label for="useAutoLayoutNames">Use Auto Layout names</label>
        </div>
      </div>
    </div>

    <!-- Figures -->
    <div class="section" id="figureLayerSection">
      <div class="group-toggle">
        <input type="checkbox" class="group-checkbox" id="toggleFigureGroup" checked>
        <label for="toggleFigureGroup" class="layer-type-header">üß© Figures</label>
      </div>
      <div class="group-settings">
        <div class="setting-item">
          <input type="checkbox" id="includeShapeType" checked>
          <label for="includeShapeType">Include shape type</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeShapeSize" checked>
          <label for="includeShapeSize">Include size</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeFillColor" checked>
          <label for="includeFillColor">Include fill color</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeStrokeSettings" checked>
          <label for="includeStrokeSettings">Include stroke settings</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeCornerRadius" checked>
          <label for="includeCornerRadius">Include corner radius</label>
        </div>
        <div class="setting-item">
          <input type="checkbox" id="includeFigureOpacity" checked>
          <label for="includeFigureOpacity">Include opacity</label>
        </div>
      </div>
    </div>
  </div>

  <div class="action-buttons">
    <button id="renameButton" class="rename-button">Rename Selected Layers</button>
  </div>

  <div class="footer">
    Made with ‚ù§Ô∏è by <a href="https://gr-ch.ru" target="_blank">grach</a>
    <div class="version"><a href="https://github.com/23grach/Renamer" target="_blank">v5.0.0</a></div>
  </div>

  <script>
    // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π —á–µ–∫–±–æ–∫—Å–æ–≤
    const previousStates = {};

    // Function to get current settings
    function getCurrentSettings() {
      return {
        // Text Layers
        enableTextLayers: document.getElementById('toggleTextGroup').checked,
        useTextContent: document.getElementById('useTextContent').checked,
        includeTextColor: document.getElementById('includeTextColor').checked,
        includeTextStyle: document.getElementById('includeTextStyle').checked,
        includeTextOpacity: document.getElementById('includeTextOpacity').checked,

        // Containers
        enableContainers: document.getElementById('toggleContainerGroup').checked,
        includeContainerType: document.getElementById('includeContainerType').checked,
        includeContainerSize: document.getElementById('includeContainerSize').checked,
        includeChildrenCount: document.getElementById('includeChildrenCount').checked,
        includeContainerOpacity: document.getElementById('includeContainerOpacity').checked,
        useFirstTextContent: document.getElementById('useFirstTextContent').checked,
        useAutoLayoutNames: document.getElementById('useAutoLayoutNames').checked,

        // Figures
        enableFigures: document.getElementById('toggleFigureGroup').checked,
        includeShapeType: document.getElementById('includeShapeType').checked,
        includeShapeSize: document.getElementById('includeShapeSize').checked,
        includeFillColor: document.getElementById('includeFillColor').checked,
        includeStrokeSettings: document.getElementById('includeStrokeSettings').checked,
        includeCornerRadius: document.getElementById('includeCornerRadius').checked,
        includeFigureOpacity: document.getElementById('includeFigureOpacity').checked
      };
    }

    // Function to save settings
    function saveSettings() {
      const settings = getCurrentSettings();
      parent.postMessage({ 
        pluginMessage: { 
          type: 'save-settings',
          settings,
          previousStates
        }
      }, '*');
    }

    // Function to toggle section enabled state
    function toggleSection(sectionId, enabled, shouldSave = true) {
      const section = document.getElementById(sectionId);
      const checkboxes = section.querySelectorAll('.group-settings input[type="checkbox"]');
      
      if (enabled) {
        // –í–∫–ª—é—á–∏—Ç—å –≥—Ä—É–ø–ø—É: –≤–∫–ª—é—á–∏—Ç—å –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã –≤–Ω—É—Ç—Ä–∏
        section.classList.remove('group-disabled');
        checkboxes.forEach(checkbox => {
          checkbox.checked = true;
        });
      } else {
        // –í—ã–∫–ª—é—á–∏—Ç—å –≥—Ä—É–ø–ø—É: –≤—ã–∫–ª—é—á–∏—Ç—å –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã –≤–Ω—É—Ç—Ä–∏
        checkboxes.forEach(checkbox => {
          checkbox.checked = false;
        });
        section.classList.add('group-disabled');
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ–∫–±–æ–∫—Å–æ–≤
      if (shouldSave) {
        saveSettings();
      }
    }

    // Add event listeners to group toggles
    document.getElementById('toggleTextGroup').addEventListener('change', (e) => {
      toggleSection('textLayerSection', e.target.checked);
    });

    document.getElementById('toggleContainerGroup').addEventListener('change', (e) => {
      toggleSection('containerLayerSection', e.target.checked);
    });

    document.getElementById('toggleFigureGroup').addEventListener('change', (e) => {
      toggleSection('figureLayerSection', e.target.checked);
    });

    // Add event listeners to all checkboxes
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
      checkbox.addEventListener('change', saveSettings);
    });

    // Add event listener to rename button
    document.getElementById('renameButton').addEventListener('click', () => {
      const settings = getCurrentSettings();
      console.log('Sending rename request with settings:', settings);
      parent.postMessage({ 
        pluginMessage: { 
          type: 'rename-with-settings',
          settings
        }
      }, '*');
    });

    // Function to apply settings to UI
    function applySettings(settings) {
      // Text Layers
      document.getElementById('toggleTextGroup').checked = settings.enableTextLayers !== undefined ? settings.enableTextLayers : true;
      document.getElementById('useTextContent').checked = settings.useTextContent !== undefined ? settings.useTextContent : true;
      document.getElementById('includeTextColor').checked = settings.includeTextColor !== undefined ? settings.includeTextColor : true;
      document.getElementById('includeTextStyle').checked = settings.includeTextStyle !== undefined ? settings.includeTextStyle : true;
      document.getElementById('includeTextOpacity').checked = settings.includeTextOpacity !== undefined ? settings.includeTextOpacity : true;

      // Containers
      document.getElementById('toggleContainerGroup').checked = settings.enableContainers !== undefined ? settings.enableContainers : true;
      document.getElementById('includeContainerType').checked = settings.includeContainerType !== undefined ? settings.includeContainerType : true;
      document.getElementById('includeContainerSize').checked = settings.includeContainerSize !== undefined ? settings.includeContainerSize : true;
      document.getElementById('includeChildrenCount').checked = settings.includeChildrenCount !== undefined ? settings.includeChildrenCount : true;
      document.getElementById('includeContainerOpacity').checked = settings.includeContainerOpacity !== undefined ? settings.includeContainerOpacity : true;
      document.getElementById('useFirstTextContent').checked = settings.useFirstTextContent !== undefined ? settings.useFirstTextContent : true;
      document.getElementById('useAutoLayoutNames').checked = settings.useAutoLayoutNames !== undefined ? settings.useAutoLayoutNames : true;

      // Figures
      document.getElementById('toggleFigureGroup').checked = settings.enableFigures !== undefined ? settings.enableFigures : true;
      document.getElementById('includeShapeType').checked = settings.includeShapeType !== undefined ? settings.includeShapeType : true;
      document.getElementById('includeShapeSize').checked = settings.includeShapeSize !== undefined ? settings.includeShapeSize : true;
      document.getElementById('includeFillColor').checked = settings.includeFillColor !== undefined ? settings.includeFillColor : true;
      document.getElementById('includeStrokeSettings').checked = settings.includeStrokeSettings !== undefined ? settings.includeStrokeSettings : true;
      document.getElementById('includeCornerRadius').checked = settings.includeCornerRadius !== undefined ? settings.includeCornerRadius : true;
      document.getElementById('includeFigureOpacity').checked = settings.includeFigureOpacity !== undefined ? settings.includeFigureOpacity : true;

      // Update section states (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –º—ã —Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∂–∞–µ–º)
      toggleSection('textLayerSection', settings.enableTextLayers !== undefined ? settings.enableTextLayers : true, false);
      toggleSection('containerLayerSection', settings.enableContainers !== undefined ? settings.enableContainers : true, false);
      toggleSection('figureLayerSection', settings.enableFigures !== undefined ? settings.enableFigures : true, false);
    }

    // Save settings when window is about to close
    window.addEventListener('beforeunload', saveSettings);

    window.onmessage = (event) => {
      const message = event.data.pluginMessage;
      
      if (message.type === 'load-settings') {
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º previousStates, –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
        if (message.previousStates) {
          Object.assign(previousStates, message.previousStates);
        }
        applySettings(message.settings);
      }
    };
  </script>
</body>
</html> 